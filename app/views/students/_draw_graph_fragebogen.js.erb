var chart<%=test%> = c3.generate({
    bindto: '#chart<%=test%>',
    data: {
        x: 'x',
        columns: [
            ['x',
                <% results.each do |r| %>
                '<%= r.measurement.date.to_date %>',
                <% end %>
            ],
            <% cats = Test.find(test).get("cat_abbrev").uniq%>
            <% cats.each do |x| %>
                ['<%= x %>',
                    <% results.each do |r| %>
                    <% unless r.nil? %>
                    <%= r.sum_cat(x).nil? ? "null" : r.sum_cat(x) %>
                    <% else %>
                    null
                    <% end %>,
                    <% end %>
                ],
            <% end %>
        ]
    },
    color: {
        pattern: [ '#208e38', '#ff0707','#2196F3', '#E040FB','#009688', '#FF9800',
                      '#F44336']
    },
    axis: {
        x: {
            type: 'timeseries',
            tick: {
                fit: true,
                format: "%e %b %y"
            },
            label: {
                text: 'Testzeitpunkte',
                position: 'outer-left'
            }
        },
        y: {
            label: {
                text: 'Positives Verhalten',
                position: 'outer-top'
            },
            min: 1,
            max: 28
        }
    },
    line: {
        connectNull: true
    },
    legend: {
        hide: false
    }
});
